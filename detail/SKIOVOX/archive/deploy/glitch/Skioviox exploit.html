<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1" />

        <!-- HTML Meta Tags -->
        <title>Skioviox exploit</title>
        <meta
            name="description"
            content="Getting an unrestricted browser on ChromeOS 115" />

        <!-- Twitter Meta Tags -->
        <meta
            name="twitter:card"
            content="summary_large_image" />
        <!--     <meta property="twitter:domain" content="ltmeat.bypassi.com" /> -->
        <!--     <meta property="twitter:url" content="https://ltmeat.bypassi.com" /> -->
        <meta
            name="twitter:title"
            content="LTMEAT for Chrome" />
        <meta
            name="twitter:description"
            content="Getting an unrestricted browser on ChromeOS 115" />
        <!--     <meta
      name="twitter:image"
      content="https://ltmeat.bypassi.com/img/gru.png"
    /> -->

        <!-- Meta Tags Generated via https://www.opengraph.xyz -->
        <title>Skioviox Exploit</title>
        <link
            rel="icon"
            href="/img/icon.png" />
        <link
            rel="stylesheet"
            href="/style.css" />
        <script
            src="/script.js"
            defer></script>
        <base target="_blank" />
    </head>
    <body>
        <div id="main-content">
            <div class="header">
                <h1 class="title">Introducing the Skioviox exploit</h1>
                <div>Getting an unrestricted browser on ChromeOS 115</div>
            </div>
            <div class="author">
                Written by <b>Bypassi</b>; see full credits at the end
            </div>
            <div class="section">
                <p class="title">How many users?</p>
                <p class="text">
                    Hello! Let's talk about ChromeOS and kiosk apps.
                </p>
                <p class="text">
                    When you turn on a school Chromebook, you normally see a
                    login screen showing one or more names, each accompanied by
                    a password prompt:
                </p>
                <img src="/img/login.png" />
                <p class="text">
                    If you've never seen a password prompt like this on your
                    school Chromebook before,
                    <b>then this exploit won't work for you.</b> Seriously.
                    Sorry.
                </p>
                <p class="text">
                    So, how many users are on the Chromebook above? Looks like
                    one, right?
                </p>
                <p class="text">
                    Actually, it's impossible to know. The true number of users
                    depends on what happens when you click the Apps button seen
                    in the bottom left of that image.
                </p>
            </div>
            <div class="section">
                <p class="title">What's a kiosk app?</p>
                <p class="text">I think chromeos.dev says it best:</p>
                <p class="text quote">
                    Kiosk mode‚Å† is a specialized way of running ChromeOS that
                    focuses on
                    <b>just one application at a time</b>. Set by an
                    administrator, kiosk applications are locked in full screen
                    and run without user login to the device.
                </p>
                <p class="text">
                    These are often used in enterprise environments for things
                    like state tests. The point is, it's just a single
                    fullscreened app window.
                </p>
                <p class="text">
                    But one thing that's really important to understand about
                    kiosk apps is that
                    <b>each kiosk app on the Chromebook is really a user.</b>
                    Each has its own:
                </p>
                <ul>
                    <li>Files</li>
                    <li>History</li>
                    <li>Extensions</li>
                    <li>Settings</li>
                    <li>Cookies</li>
                </ul>
                <p class="text">
                    So if a Chromebook has 1 real user account and 6 kiosk apps,
                    it's technically storing 7 users.
                </p>
                <img src="/img/baggage.png" />
                <p class="text">
                    Now, this is obviously some insane overkill, because kiosk
                    apps would never have to use 90% of these features. But
                    ChromeOS is notoriously consistent with its design; even the
                    first "connect to network" screen you see is written in
                    HTML, JS, and CSS.
                </p>
                <p class="text">
                    In fact, the only things seperating kiosk apps from being a
                    full unblocked browser is the fact that a certain app is
                    launched and full-screened. If that doesn't sound very
                    reassuring to you, that's because it isn't.
                </p>
            </div>
            <div class="section">
                <p class="title">The old kiosk exploit</p>
                <p class="text">
                    The year is 2020. Google is releasing ChromeOS 86, which
                    happens to patch a certain exploit. At this time, only a
                    dozen people or so are aware that this exploit exists.
                </p>
                <p class="text">
                    The exploit was, in short, a race condition that allowed a
                    user to open an unrestricted window instead of a kiosk app.
                    The issue stemmed from two things:
                    <b>the kiosk network error page</b> and <b>ChromeVox</b>.
                </p>
                <p class="text">
                    ChromeVox is the text-to-speech (Spoken Feedback)
                    accessibility extension for ChromeOS. It can be turned on by
                    pressing
                    <code>ctrl+alt+z</code>. It can also be accessed in Kiosk
                    apps. Some ChromeVox shortcuts open help pages.
                </p>
                <p class="text">
                    The issue was that, if timed correctly, these help pages
                    could be opened while in the middle of a navigation from the
                    kiosk network error page, leading to an unblocked browser:
                </p>
                <img src="/img/old-net-error.png" />
                <p class="text">
                    Why was this exploit so good? Well, ChromeOS policies are
                    split into two categories: <b>device and user.</b> And
                    since, technically, no administrator-controlled account was
                    signed into Chrome, user policies did not apply. So:
                </p>
                <ul>
                    <li>Any extension could be sideloaded</li>
                    <li>Any account could be logged into</li>
                    <li>Most blocklists did not apply</li>
                </ul>
                <p class="text">
                    There was no other exploit capable of bypassing the
                    URLBlockList policy. But the first kiosk exploit didn't work
                    perfectly every time, and it could only be done once per
                    powerwash. So, sadly, it wasn't optimal.
                </p>
                <!--       <p class="text">
        Recently, Titanium Network moderautor aub curated a consistent root
        escalation exploit that allowed for unenrolling the Chromebook. (Sound
        familiar?)
      </p> -->
                <p class="text">
                    There is so much more history to this exploit, and I can't
                    do justice to it here. If you want to see more, check out
                    <a
                        href="https://docs.google.com/presentation/d/1lM49q3z_MYcUawqKjle1TACn0w37qdoFjW8huW_AWEQ/edit"
                        >my friend Cor's instructions on using the exploit.</a
                    >
                </p>
                <p class="text">
                    Sadly, with the barrage of SH1MMER patches, you can't
                    downgrade to the old versions from 2020 anymore. So that
                    category of exploit is patched and gone.
                </p>
            </div>
            <div class="section">
                <p class="title">Blunder!</p>
                <p class="text">
                    Well, the exploit was patched for some time. But then Google
                    made a mistake, and
                    <a href="https://en.wikipedia.org/wiki/Swiss_cheese_model"
                        >the holes lined up.</a
                    >
                </p>
                <img src="/img/cheese.png" />
                <p class="text">
                    So, spoiler alert, in case you haven't figured out already:
                    there's another kiosk exploit. And this new kiosk
                    exploit--named
                    <b>Skiovox</b>--stems from two things:
                    <b>the kiosk network error page</b> and <b>ChromeVox</b>.
                </p>
                <p class="text">
                    Wait a second, isn't this the same thing? Yes, it basically
                    is. And it's even more hilarious now.
                </p>
            </div>
            <div class="section">
                <p class="title">One broken button and one forgotten key</p>
                <p class="text">
                    The real cause of this issue is a single button: the "Back"
                    button on the current kiosk network error page, which has
                    been broken for quite some time now.
                </p>
                <img src="/img/back-button.png" />
                <p class="text">
                    This button should take the user back to the
                    <a href="/img/login.png">regular sign-in screen.</a> But it
                    doesn't.
                </p>
                <p class="text">
                    There's a little-known and rarely-used feature on
                    Chromebooks called secondary accounts, also known as
                    <a
                        href="https://support.google.com/chromebook/answer/6088201"
                        >multiple sign-in.</a
                    >
                    In short, two ChromeOS accounts can be signed in at the same
                    time. This differs greatly from having two Google accounts
                    signed into a single ChromeOS account.
                </p>
                <img src="/img/accounts.png" />
                <p class="text">
                    ChromeOS accounts each have their own browsing profile and
                    policies. Google accounts are only used to sign into Google
                    services like Play Store and YouTube.
                </p>
                <p class="text">
                    Back to kiosk. When you click the back button from the
                    network error page, you are shown a slightly modified
                    version of the regular log-in screen. Specifically, there
                    isn't an "Apps" button in the bottom left, and there's no
                    toolbar in the bottom right.
                </p>
                <img src="/img/login-2.png" />
                <p class="text">
                    What's happening here is that your school account is being
                    added as a secondary account. Recall that kiosk apps are
                    actually users--this means that your kiosk app is the
                    primary account.
                    <b>
                        You are signed into both a kiosk app profile and your
                        school profile at the same time.
                    </b>
                </p>
                <p class="text">
                    Now, most administrators prevent school accounts from being
                    used as secondary accounts. A dialog shows up, blocking the
                    whole screen and forcing the user to sign out. Well, unless
                    they press the escape key, which bypasses the dialog
                    completely.
                </p>
                <img src="/img/esc.png" />
                <p class="text">
                    So now you are in a weird, kinda-kiosk state. For example,
                    keyboard shortcuts like <code>ctrl+t</code> are still
                    restricted the same way they are in a kiosk app. Also, all
                    smoothing animations seem to be removed, along with the
                    fullscreen controls for windows.
                </p>
                <img src="/img/window.png" />
                <p class="text">
                    But on the surface, this just seems like an uncanny and
                    broken version of your school account, interesting but not
                    exploitable.
                </p>
            </div>
            <div class="section">
                <p class="title">The return of ChromeVox</p>
                <p class="text">
                    But, in ChromeOS version 114, Google made a big mistake.
                </p>
                <p class="text">
                    Remember ChromeVox, the text-to-speech feature?
                    <b>
                        This new mistake allows ChromeVox help windows to once
                        again be loaded while in a kiosk app.
                    </b>
                    But they're loaded in the background, invisibly, which would
                    be useless if not for the back button issue.
                </p>
                <p class="text">
                    This chain of issues can be turned into an exploit:
                </p>
                <ul>
                    <li>
                        A user can open ChromeVox help in a new browser window,
                        in the background of a kiosk app
                    </li>
                    <li>
                        A user can close the kiosk app without exiting the kiosk
                        profile or closing the help window
                    </li>
                    <li>
                        The user can use their school account as a secondary
                        account
                    </li>
                    <li>
                        The restriction-free Chrome window running in the kiosk
                        profile can now be used
                    </li>
                </ul>
                <!--    Image here    -->
                <p class="text">
                    Before I get to any specific instructions, I want to mention
                    the pitfalls of this exploit:
                </p>
                <ul>
                    <li>Browser shortcuts do not work</li>
                    <li>Logging in with Google is seemingly broken</li>
                    <li>Windows cannot easily be moved or resized</li>
                    <li>The exploit can be patched if ChromeVox is disabled</li>
                </ul>
                <p class="text">
                    In the next sections, I will also introduce a solution to
                    these issues.
                </p>
            </div>
            <div class="section">
                <p class="title">The instructions</p>
                <p class="text">
                    <b>Step 1:</b> Sign out of your Chromebook. Again, it should
                    look like this:
                </p>
                <img src="/img/login.png" />
                <p class="text">
                    And again, if it doesn't, you can't do this exploit.
                </p>
                <p class="text">
                    <b>Step 2:</b> Click the time and click turn off your Wi-Fi.
                </p>
                <p class="text">
                    <b>Step 3:</b> Click the "Apps" button in the bottom left
                    and enter a kiosk app. Kiosk apps that are
                    <a
                        href="https://developer.chrome.com/docs/apps/manifest/offline_enabled/"
                        >offline enabled</a
                    >
                    won't work, but very few apps have this capability.
                    <b>
                        It's very important that you try to use the same kiosk
                        app every time you do this exploit.
                    </b>
                    Remember, every kiosk app is a user, and you want your stuff
                    to be saved.
                </p>
                <p class="text">
                    <b>Step 4:</b> Wait until you get to the loading screen
                    stage which says "waiting for network connection". You can
                    also just wait for the error page just to be sure:
                </p>
                <img src="/img/back-button.png" />
                <p class="text">
                    <b>Step 5:</b> Press <code>ctrl+alt+z</code>. You should get
                    a ringing noise and a creepy voice saying something like
                    "ChromeVox spoken feedback is ready". If nothing happens and
                    this is your first time trying the exploit, too bad. Give
                    up.
                </p>
                <p class="text">
                    <b>Step 6:</b> Hold down
                    <a href="/img/search.png">the search key</a> while pressing
                    the following keys in order: <code>o</code> and
                    <code>t</code>. A screen like this should now pop up:
                </p>
                <img src="/img/resources.png" />
                <p class="text">
                    <b>Step 7:</b> Click "Resources", then click any one of the
                    three links that show up.
                </p>
                <p class="text">
                    <b>Step 8:</b> Click "Exit Tutorial", then turn off
                    ChromeVox by pressing <code>ctrl+alt+z</code> again.
                </p>
                <p class="text">
                    <b>Step 9:</b> This following step has to be done within
                    around 6 seconds, although it depends on the speed of your
                    Chromebook:
                </p>
                <ul>
                    <li>
                        Click "Add other Wi-Fi network" on the error page; this
                        will turn your Wi-Fi back on
                    </li>
                    <li>
                        Press the escape key twice to exit the error page and
                        get to the secondary sign-in screen
                    </li>
                    <li>Type in your password and press enter</li>
                </ul>
                <p class="text">
                    If your Chromebook connects to Wi-Fi before you type in your
                    password, you will get kicked back to the kiosk app before
                    your secondary account is added, which is bad.
                </p>
                <p class="text">
                    If you're a slow typer, or just have a long password, check
                    the alternative method for a more reliable way to trigger
                    the exploit.
                </p>
                <a
                    class="button"
                    id="show-alternate">
                    Show alternate method
                </a>
                <p class="text">
                    <b>Step 10:</b> If a dialog shows up saying that all users
                    must sign out, just press the escape key to bypass it.
                </p>
                <p class="text">
                    You should now have an unblocked browser open, with no
                    extensions installed.
                    <b>The root of this exploit was found by @akabutnice</b> on
                    Discord, who reached out to me before releasing it, which is
                    awesome. I decided to do some extra work with it, and I
                    highly recommend that anyone planning on using the exploit
                    reads the next section.
                </p>
            </div>
            <div class="section">
                <p class="title">The Skiovox Helper Extension</p>
                <p class="text">
                    So even once you are in the unblocked browser, there are
                    some issues. As I mentioned earlier, these issues are:
                </p>
                <ul>
                    <li>Browser shortcuts do not work</li>
                    <li>Logging in with Google is seemingly broken</li>
                    <li>Windows cannot easily be moved or resized</li>
                    <li>The exploit can be patched if ChromeVox is disabled</li>
                </ul>
                <p class="text">
                    So I put together a team to fix these issues. We decided to
                    make a Chrome extension which the user could "sideload" with
                    unpacked installation. The extension fixes these issues:
                </p>
                <ul>
                    <li>
                        It re-adds the functionality of a dozen shortcuts like
                        <code>ctrl+t</code> and <code>ctrl+w</code>. Note that
                        <code>alt+tab</code> is moved to <code>alt+q</code> and
                        <code>ctrl+tab</code> is moved to <code>ctrl+q</code>.
                    </li>
                    <li>
                        It links to a working Google login page where an account
                        can be added.
                    </li>
                    <li>
                        It adds buttons in the new tab page that can maximize
                        and drag the focused window.
                    </li>
                </ul>
                <!--     image of the homepage   -->
                <p class="text">
                    Most importantly, the extension automatically creates an
                    unblocked window by itself,
                    <b>
                        so ChromeVox (steps 5-8) is no longer necessary to
                        trigger the exploit.
                    </b>
                </p>
                <p class="text">
                    The extension also provides additional conveniences:
                </p>
                <ul>
                    <li>
                        It allows the user to open the ChromeOS file manager in
                        their browser.
                    </li>
                    <li>
                        It allows a user to open a Chrome window logged into
                        their school (managed) account, with school extensions
                        and policies active.
                        <b>Useful for emergencies.</b> Note that the keyboard
                        shortcut fixes do not apply to the managed window.
                    </li>
                    <li>
                        It provides a simple way to install an extension from
                        the Chrome Web Store.
                    </li>
                    <li>
                        It allows users to log out of the exploit and save their
                        work without using the power button.
                    </li>
                </ul>
            </div>
            <div class="section">
                <p class="title">Installing the helper extension</p>
            </div>
        </div>
    </body>
</html>
